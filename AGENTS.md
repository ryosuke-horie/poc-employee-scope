# Repository Guidelines

このリポジトリは設計および要件ドキュメントを管理します。変更は小さく、範囲を明確にし、必要に応じて事前に issue を作成してください。

## プロジェクト構成とモジュール整理
- ルート: トップレベル文書（`README.md`, `AGENTS.md`）。
- `docs/`: ドキュメント一式。
  - `docs/requirements.md`: 課題・スコープ。
  - `docs/design.md`: 高レベル設計とトレードオフ。
  - `docs/technical_design.md`: 詳細フロー・インターフェース・決定事項。
- 新規文書は `docs/` 配下に、目的が分かる kebab-case 名で追加（例: `docs/api-contracts.md`）。

## ビルド・テスト・開発コマンド
本リポジトリにはビルドや実行は不要です。Markdown を編集し、エディタでプレビューしてください。
- 任意: ローカルで Markdown リント（例: `markdownlint **/*.md`）。現時点で CI 要件はありません。

## コーディングスタイル・命名規則
- ファイル: `kebab-case.md` を推奨（例: `data-model.md`）。
- 見出し: 本文はセンテンスケースを推奨。階層は `#` → `##` → `###` を厳守。
- 箇条書き/コード: 簡潔な箇条書き、フェンスコードは言語タグ付き。
- リンク: リポジトリ内は相対リンク（例: `[Design](docs/design.md)`）。
- トーン: 明瞭・客観・意思決定を明示。判断理由と代替案を短く併記。

## テスト方針
自動テストはありません。将来コード資産を追加する場合は次を徹底:
- テストは `tests/` に配置し、ソース構成をミラー。
- 採用フレームワークと実行コマンドを本節に追記。

## コミットとプルリクエスト
- コミット: 1 変更 1 コミット。命令形で短く（例: "Add API section"）。関連 issue を参照（例: `#123`）。
- PR: 目的/範囲、影響ファイル（パス）、主要な決定点、レンダリング確認チェックリスト、必要に応じてスクリーンショット/図を含める。

## アーキテクチャと決定記録
- 重要な決定は `docs/technical_design.md` に日付と背景を記録。大きなテーマは専用文書を作成し、設計文書からリンク。

## セキュリティと機密情報
- 秘密情報・トークン・非公開エンドポイントをコミットしない。伏字とプレースホルダーを明示。

## エージェント/貢献者向け
- 段階的な PR を優先し、大規模な横断編集は避ける。
- タイトル、リンク、例は読者が再現できる形で維持。
- エージェント実行とコミット: 単一のプロンプトに対するエージェントの実装/対応は、作業完了時に必ずコミットで締める（可能なら「1 プロンプト = 1 コミット」）。コミットメッセージは命令形で要約し、関連 issue を参照。

```sh
git add -A
git commit -m "docs: エージェント対応: ◯◯を更新 (#123)"
```

## 役割分担（Codex と Claude）
- Codex（本エージェント）: PDM/仕様策定・表現定義・進行管理を担当。
  - タスク分割と `tasks.md` の維持、インターフェース定義、命名規則、PR 説明作成、レビュー観点の提示。
  - 実装ソース生成は行わない。必要な仕様/契約（I/O、エラーポリシー、例）を明記して「Claude向けプロンプト案」を提示する。
- Claude: 実装・ビルド・テスト・最適化を担当。
  - `docs/` と `tasks.md` に基づき、TypeScript 実装、単体テスト、動作確認を遂行。
- ユーザー（仲介）: Codexが提示したプロンプト案を人の目で確認・修正し、問題なければ Claude に依頼する。Codexは Claude に直接指示やコマンド実行を行わない。

## ヒューマン・イン・ザ・ループ運用
- 起票: Codex は回答内に「Claude向けプロンプト案」を提示し、同時に `tasks.md` を更新する。
- レビュー: ユーザーがプロンプト案を確認・修正・承認。承認なしで Claude への依頼は行わない。
- 依頼/実装: ユーザーが Claude に依頼し、Claude が実装・テストを実施。
- 反映/記録: ユーザーが結果を取り込み、Codex はドキュメント/タスクを更新して「1プロンプト=1コミット」で履歴化。
- 禁止事項: Codex は Claude への直接メッセージ送信・コマンド実行・API呼出を行わない。機密をプロンプトに含めない。ユーザー承認前に大規模変更を行わない。
