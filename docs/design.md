# 設計書
## 1. システム概要
本システムは、ローカルPC上で対象企業の従業員数を自動収集するPoCである。
情報収集はスクレイピングまたは検索APIを通じて行い、正規表現およびLLMにより従業員数を抽出する。
抽出結果は出典URLと共にDBまたはCSVに保存され、担当者が確認可能とする。

## 2. アーキテクチャ
[companies.csv]
↓
[URL収集: 固定URL（手動指定）]
↓
[ページ取得: Playwright]
↓
[抽出: regex → LLM(OpenRouter)]
↓
[出典/数値 保存: SQLite/CSV]
↓
[確認: CSV/DB Viewer]


## 3. モジュール構成
1. **データ入力モジュール**
   - CSV読み込み、企業名リスト生成
2. **URL収集モジュール**
   - SerpApi呼び出しまたは固定URLリスト使用
3. **ページ取得モジュール**
   - PlaywrightでHTML取得、テキスト化
4. **抽出モジュール**
   - 正規表現で抽出
   - 見つからない場合、LLM APIで抽出
5. **保存モジュール**
   - SQLiteに保存（`companies`, `evidence` テーブル）
6. **確認モジュール**
   - CSVエクスポートまたはSQLiteブラウザで閲覧

## 4. データフロー
1. CSVから企業名読み込み
2. 検索APIまたは事前設定URLで候補URL取得
3. ページ取得とテキスト抽出
4. 正規表現で従業員数検出
5. 見つからない場合はLLMで抽出
6. 値と出典をDBに保存
7. 人間が承認または修正

## 5. 外部インターフェース
- **入力**: CSVファイル
- **出力**: SQLite DB / CSVファイル
- **API利用**:
  - OpenRouter API（Chat Completions互換）

## 6. 想定利用手順
1. `companies.csv`に対象企業を記載
2. `.env`にAPIキーまたはOllamaモデル設定
3. CLIからスクリプト実行
4. 出力結果を確認・承認
